Base:
  User: todoroki
  Keyfile: $KEYFILE
  Sudopass: $SUDOPASS
  Nodes:
    publisher-1:
      address: 10.20.22.158
    subscriber-1:
      address: 10.20.22.159
    broker-1:
      address: 10.20.22.161
    broker-2:
      address: 10.20.22.162
    broker-3:
      address: 10.20.22.163
    manager:
      address: 10.20.22.164
      is_manager: true

Systems:
  type: kafka
  duration: 1m
  Broker:
    zookeeper:
      containers:
        zoo-1:
          node_name: broker-1
          environment:
            ZOOKEEPER_CLIENT_PORT: 2181
            ZOOKEEPER_TICK_TIME: 2000
        zoo-2:
          node_name: broker-2
          environment:
            ZOOKEEPER_CLIENT_PORT: 2181
            ZOOKEEPER_TICK_TIME: 2000
        zoo-3:
          node_name: broker-3
          environment:
            ZOOKEEPER_CLIENT_PORT: 2181
            ZOOKEEPER_TICK_TIME: 2000
    kafka:
      containers:
        kafka-1:
          node_name: broker-1
          environment:
            KAFKA_BROKER_ID: 1
            KAFKA_LISTENER_SECURITY_PROTOCOL_MAP: INSIDE:PLAINTEXT
            KAFKA_ADVERTISED_LISTENERS: INSIDE://kafka-1:9092
            KAFKA_ZOOKEEPER_CONNECT: zoo-1:2181
            KAFKA_LISTENER_SECURITY_PROTOCOL_MAP: INSIDE:PLAINTEXT
            KAFKA_INTER_BROKER_LISTENER_NAME: INSIDE
            KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR: 1
        kafka-2:
          node_name: broker-2
          environment:
            KAFKA_BROKER_ID: 2
            KAFKA_LISTENER_SECURITY_PROTOCOL_MAP: INSIDE:PLAINTEXT
            KAFKA_ADVERTISED_LISTENERS: INSIDE://kafka-2:9092
            KAFKA_ZOOKEEPER_CONNECT: zoo-1:2181
            KAFKA_LISTENER_SECURITY_PROTOCOL_MAP: INSIDE:PLAINTEXT
            KAFKA_INTER_BROKER_LISTENER_NAME: INSIDE
        kafka-3:
          node_name: broker-3
          environment:
            KAFKA_BROKER_ID: 3
            KAFKA_ADVERTISED_LISTENERS: INSIDE://kafka-3:9092
            KAFKA_ZOOKEEPER_CONNECT: zoo-1:2181
            KAFKA_LISTENER_SECURITY_PROTOCOL_MAP: INSIDE:PLAINTEXT
            KAFKA_INTER_BROKER_LISTENER_NAME: INSIDE
    topics:
        brokers:
          - kafka-1:9092
          - kafka-2:9092
          - kafka-3:9092
        list:
          - "test-topic:3:1"
  Publisher:
    containers:
      pub-1:
        node_name: publisher-1
        params:
          number: 1
          message_size: 1k
          message_rate: 100k
          brokers: 
            - kafka-1:9092
            - kafka-2:9092
            - kafka-3:9092
          topic: "test-topic"
  Subscriber:
    containers:
      sub-1:
        node_name: subscriber-1
        params:
          number: 1
          record_message: true
          brokers: 
            - kafka-1:9092
            - kafka-2:9092
            - kafka-3:9092
          topic: "test-topic"

Actions:
  delay1:
    target_containers:
      - kafka-1
    start: 20s
    duration: 20s
    # destination:
    #   - kafka-2
    mode: delay
    params:
      time: 100